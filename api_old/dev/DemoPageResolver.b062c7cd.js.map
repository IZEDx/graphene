{"version":3,"sources":["services/DemoPageService.ts","resolvers/demoPage/DemoPageResolver.ts"],"names":[],"mappings":"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","file":"DemoPageResolver.b062c7cd.js","sourceRoot":"../src","sourcesContent":["import { Service, Inject } from \"typedi\";\r\nimport { GrapheneServer } from \"../server\";\r\nimport DemoPage from \"../models/DemoPage\";\r\nimport { CreatePageInput, EditPageInput } from \"../resolvers/demoPage/DemoPageResolver\";\r\nimport User from \"../models/User\";\r\nimport { Tracer } from \"tracer\";\r\n\r\n\r\n@Service()\r\nexport class DemoPageService\r\n{\r\n\r\n    @Inject(\"server\") server: GrapheneServer;\r\n    @Inject(\"logger\") logger: Tracer.Logger;\r\n\r\n    getAll()\r\n    {\r\n        return DemoPage.find();\r\n    }\r\n\r\n    getOne(id: string)\r\n    {\r\n        return DemoPage.findOne({where: {id}});\r\n    }\r\n\r\n    create(data: CreatePageInput, user: User)\r\n    {\r\n\r\n        const page = DemoPage.create({\r\n            ...data, \r\n            author: user\r\n        });\r\n\r\n        console.log({\r\n            ...data, \r\n            author: user\r\n        });\r\n\r\n        return page.save();\r\n    }\r\n\r\n    async edit(data: EditPageInput)\r\n    {\r\n        const page = await this.getOne(data.id);\r\n        if (!page) throw new Error(\"Page not found: \" + data.id);\r\n\r\n        Object.assign(page, {\r\n            ...data, \r\n            id: page.id\r\n        });\r\n\r\n        return page.save();\r\n    }\r\n\r\n    async delete(id: string)\r\n    {\r\n        const page = await this.getOne(id);\r\n        if (!page) throw new Error(\"Page not found: \" + id);\r\n\r\n        return page.remove();\r\n    }\r\n}","import { Arg, Query, Resolver, Mutation, Authorized, Ctx, InputType, Field, FieldResolver, Root, ResolverInterface } from \"type-graphql\";\r\nimport User from \"../../models/User\";\r\nimport { GrapheneContext } from \"../../server\";\r\nimport { Service } from \"typedi\";\r\nimport DemoPage from \"../../models/DemoPage\";\r\nimport { DemoPageService } from \"../../services/DemoPageService\";\r\nimport { RichContent } from \"../../models/scalars/RichContent\";\r\n\r\n@InputType()\r\nexport class CreatePageInput {\r\n    @Field()\r\n    title: string;\r\n\r\n    @Field(type => RichContent)\r\n    content: string;\r\n}\r\n\r\n@InputType()\r\nexport class EditPageInput {\r\n    @Field()\r\n    id: string;\r\n\r\n    @Field()\r\n    title: string;\r\n\r\n    @Field(type => RichContent)\r\n    content: string;\r\n}\r\n\r\n\r\n@Service()\r\n@Resolver(of => DemoPage)\r\nexport default class DemoPageResolver\r\n{\r\n    constructor(\r\n        private readonly pageService: DemoPageService\r\n    ){}\r\n\r\n    @Query(returns => [DemoPage])\r\n    demoPages()\r\n    {\r\n        return this.pageService.getAll();\r\n    }\r\n\r\n    @Query(() => DemoPage)\r\n    demoPage(@Arg(\"id\") id: string) \r\n    {\r\n        return this.pageService.getOne(id);\r\n    }\r\n\r\n    @Authorized(\"ADMIN\")\r\n    @Mutation(() => DemoPage)\r\n    async createDemoPage(@Arg(\"data\") data: CreatePageInput, @Ctx() context: GrapheneContext) \r\n    {\r\n        const user = await User.findOne({ where: { id: context.user.id } });\r\n        return this.pageService.create(data, user!);\r\n    }\r\n\r\n    @Authorized(\"ADMIN\")\r\n    @Mutation(() => DemoPage)\r\n    async editDemoPage(@Arg(\"data\") data: EditPageInput, @Ctx() context: GrapheneContext) \r\n    {\r\n        return this.pageService.edit(data);\r\n    }\r\n\r\n    @Authorized(\"ADMIN\")\r\n    @Mutation(() => DemoPage)\r\n    async deleteDemoPage(@Arg(\"id\") id: string) \r\n    {\r\n        return this.pageService.delete(id);\r\n    }\r\n} "]}